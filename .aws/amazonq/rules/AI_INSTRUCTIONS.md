# AI作業指示書

## 🚨 最重要事項

### ユーザー指示なしの変更禁止
- **絶対禁止**: ユーザーの明示的な指示なしにファイルを変更すること
- **適用範囲**: 全てのファイル（コード、設定、ドキュメント等）
- **例外なし**: 「改善のため」「最適化のため」等の理由でも禁止
- **確認必須**: 変更前に必ずユーザーの許可を得ること

### 指示書変更の特別ルール
- **超重要**: 指示書（AI_INSTRUCTIONS.md、DEVELOPMENT_RULES.md）の変更は特別扱い
- **独立した許可**: 一般的なファイル変更許可があっても、指示書変更には別途明確な指示が必要
- **明示的指示**: ユーザーが「指示書を変更して」と明確に指示した場合のみ変更可能
- **自動更新禁止**: 他の作業中に「ついでに」指示書を更新することは絶対禁止
- **例**: 機能実装の指示があっても、指示書への言及がなければ指示書は変更しない

### 許可される行為
- ファイル内容の確認・検索
- 構文チェック・検証
- 情報の提供・説明
- 提案・推奨事項の提示

### 禁止される行為
- ファイルの作成・編集・削除
- コミット・プッシュの実行
- 設定の変更
- データの修正

**重要**: この原則に違反した場合、即座に作業を停止し、ユーザーに報告すること

---

## 基本作業フロー

### 1. 作業開始時
- `DEVELOPMENT_RULES.md`の内容を確認
- 現在のプロジェクト状態を把握
- `HISTORY.md`で最新の変更履歴を確認

### 2. コード修正時
- 修正前に関連ファイルの現在の状態を確認
- 変更の影響範囲を検討
- テスト可能な修正を実装

### 3. コミット前チェックリスト
```bash
# 必須確認項目
1. DEBUG_MODE = false の確認
   grep "DEBUG_MODE" docs/index.html
   
2. 構文エラーの確認
   # CSS括弧の確認
   grep -o "{" docs/index.html | wc -l
   grep -o "}" docs/index.html | wc -l
   
3. 動作テスト
   # ブラウザでの表示確認
   # 主要機能の動作確認
```

### 4. コミット・プッシュ実行
```bash
# 標準的なコミット手順
git add .
git commit -m "適切な英語のコミットメッセージ"
git push
```

## 頻出作業パターン

### セッションデータ更新
```bash
# データ抽出スクリプト実行
python3 extract_sessions.py

# 結果確認
echo "総セッション数の確認"
grep -c "time" docs/sessions.json
```

### CSS修正
- レスポンシブ対応を常に考慮
- 既存のデザインとの整合性を保持
- ブラウザ互換性を確認

### JavaScript修正
- `debugLog()`関数を使用してデバッグログを実装
- `DEBUG_MODE`フラグで制御
- エラーハンドリングを適切に実装

## 自動化可能な作業

### 許可される自動実行
- ファイル内容の確認・検索
- 構文チェック
- テストスクリプトの実行
- データ生成スクリプトの実行

### 手動確認が必要な作業
- コミット・プッシュ（DEBUG_MODE確認後）
- 重要なファイルの削除・移動
- 外部APIの呼び出し
- セキュリティに関わる変更

## エラー対応

### よくあるエラーと対処法

#### CSS構文エラー
```bash
# 括弧の数を確認
echo "開始括弧:" && grep -o "{" docs/index.html | wc -l
echo "終了括弧:" && grep -o "}" docs/index.html | wc -l
```

#### JavaScript構文エラー
- ブラウザの開発者ツールでコンソールエラーを確認
- 関数の定義と呼び出しの整合性を確認

#### データ整合性エラー
```bash
# JSONの構文確認
python3 -m json.tool docs/sessions.json > /dev/null && echo "JSON OK" || echo "JSON Error"
```

## 品質保証

### コード品質チェック
- 命名規則の遵守
- コメントの適切性
- 冗長なコードの排除

### ユーザビリティチェック
- レスポンシブデザインの確認
- アクセシビリティの考慮
- パフォーマンスの最適化

### セキュリティチェック
- XSS対策の実装
- 外部リンクの安全性
- データサニタイズの実装

## 変更履歴の記録

### HISTORY.md更新タイミング
- 新機能追加時
- 重要なバグ修正時
- UI/UXの大幅な変更時
- パフォーマンス改善時

### 記録フォーマット
```markdown
### 機能名
- 実装内容の概要
- 技術的詳細
- 修正したファイル
- ユーザーへの影響
```

## 緊急時対応

### 問題発生時の対応順序
1. 問題の特定と影響範囲の確認
2. 一時的な回避策の検討
3. 根本的な修正の実装
4. テストと検証
5. デプロイと監視

### ロールバック手順
```bash
# 直前のコミットに戻す
git revert HEAD

# 特定のコミットに戻す
git revert <commit-hash>

# 強制的に戻す（注意が必要）
git reset --hard <commit-hash>
```

---

**重要**: この指示書に従って作業を行い、不明な点があれば確認を求めてください。新しいパターンや改善点があれば、この指示書を更新してください。
